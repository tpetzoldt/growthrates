<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimation of Growth Rates with Package `growthrates`, Part 1: Introduction • growthrates</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of Growth Rates with Package `growthrates`, Part 1: Introduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">growthrates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Introduction.html">Estimation of Growth Rates with Package `growthrates`, Part 1: Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/User_models.html">Estimation of Growth Rates with Package `growthrates`, Part 2: User-defined Growth Models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tpetzoldt/growthrates/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimation of Growth Rates with Package `growthrates`, Part 1: Introduction</h1>
                        <h4 data-toc-skip class="author">Thomas
Petzoldt</h4>
            
            <h4 data-toc-skip class="date">2025-08-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tpetzoldt/growthrates/blob/master/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<!--
possible output options are:
rmarkdown::pdf_document
rmarkdown::html_vignette

set to UTF if necessary with:
%\VignetteEncoding{UTF-8}

Bibliographies may need to set the LANG environment variable
LANG=en_US.UTF-8
-->
<p><strong>Please note:</strong> This document reflects work in progress
and will be updated from time to time. The most recent copy can be found
at <a href="https://tpetzoldt.github.io/growthrates/doc/Introduction.html" class="external-link uri">https://tpetzoldt.github.io/growthrates/doc/Introduction.html</a></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The growth rate of a population is a direct measure of fitness.
Therefore, determination of growth rates is common in many disciplines
of theoretical and applied biology, e.g. physiology, ecology,
eco-toxicology or pharmacology. This package aims to streamline
estimation of growth rates from direct or indirect measures of
population density (e.g. cell counts, optical density or fluorescence)
determined in batch experiments or field observations. It should be
applicable to different species of bacteria, archaea, protists, and
metazoa, e.g. <em>E. coli</em>, <em>Cyanobacteria</em>,
<em>Paramecium</em>, green algae or <em>Daphnia</em>.</p>
<p>The determination of growth rates from chemostat and semi-continuous
cultures is currently not covered by the package, but we are open to
include it, depending on your interest and the availability of data. The
package is still under development and feedback is highly welcome.</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>The package includes three types of methods:</p>
<ol style="list-style-type: decimal">
<li>Nonlinear fitting of parametric growth models like the logistic or
the Gompertz growth model. Parametric model fitting is done by using
package <code>FME</code> (Flexible Modelling Environment) of <span class="citation">Soetaert and Petzoldt (2010)</span>. In addition to
growth models given in closed form (i.e. empirical regression equations
or analytical solutions of differential equations) it is also possible
to use numerically integrated systems of differential equation. Such
models are then solved with package `deSolve’ <span class="citation">(Soetaert, Petzoldt, and Setzer 2010)</span>.</li>
<li>Fitting of linear models to the period of exponential growth using
the ``growth rates made easy method’’ of <span class="citation">Hall et
al. (2014)</span> ,</li>
<li>Nonparametric growthrate estimation by using smoothers. R contains
several powerful smoothing methods, that can leveraged for this purpose.
The currently implemented method uses function
<code>smooth.spline</code>, similar to the package <code>grofit</code>
<span class="citation">(Kahm et al. 2010)</span>.</li>
</ol>
<p>The package contains methods to fit single data sets or complete
series of data sets organized in a data frame. It contains also
functions for extracting results (e.g. <code>coef</code>,
<code>summary</code>, <code>deviance</code>, <code>obs</code>,
<code>residuals</code>, <code>rsquared</code> and <code>results</code>)
and methods for plotting (<code>plot</code>, <code>lines</code>). The
implementation follows an object oriented style, so that the functions
above determine automatically which method is used for a given class of
objects.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The stable version of the package can be installed as usual from
within <strong>R</strong> or <strong>RStudio</strong> like any other
package, or with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"growthrates"</span><span class="op">)</span></span></code></pre></div>
<p>The development version and full source code are available from <a href="https://github.com/tpetzoldt/growthrates" class="external-link uri">https://github.com/tpetzoldt/growthrates</a> .</p>
</div>
<div class="section level2">
<h2 id="data-set">Data set<a class="anchor" aria-label="anchor" href="#data-set"></a>
</h2>
<p>The data set for demonstrating main features of the package was
provided by Claudia Seiler from one of a series of plate reader
experiments carried out at the Institute of Hydrobiology of TU Dresden.
It describes growth of three different strains of bacteria (D = Donor, R
= Recipient, T = transconjugant) in dependence of a gradient of the
antibiotics tetracycline.</p>
<p>After loading the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/tpetzoldt/growthrates" class="external-link">"growthrates"</a></span><span class="op">)</span></span></code></pre></div>
<p>we load the data and inspect its structure with <code>str</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bactgrowth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bactgrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    2232 obs. of  5 variables:</span></span>
<span><span class="co">##  $ strain   : Factor w/ 3 levels "D","R","T": 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ replicate: int  2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ conc     : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ time     : int  0 1 2 3 4 5 6 7 8 9 ...</span></span>
<span><span class="co">##  $ value    : num  0.013 0.014 0.017 0.022 0.03 0.039 0.042 0.045 0.048 0.049 ...</span></span></code></pre>
<p>And we can also inspect the full data set with
<code>View(growthrates)</code> or look at the first few lines with
<code>head</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bactgrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   strain replicate conc time value</span></span>
<span><span class="co">## 1      T         2    0    0 0.013</span></span>
<span><span class="co">## 2      T         2    0    1 0.014</span></span>
<span><span class="co">## 3      T         2    0    2 0.017</span></span>
<span><span class="co">## 4      T         2    0    3 0.022</span></span>
<span><span class="co">## 5      T         2    0    4 0.030</span></span>
<span><span class="co">## 6      T         2    0    5 0.039</span></span></code></pre>
<p>or we can plot raw data with <strong>ggplot</strong>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">bactgrowth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>replicate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">replicate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">strain</span> <span class="op">~</span> <span class="va">conc</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-5-1.png" width="864"></p>
<p>Or the same with the <strong>lattice</strong> package:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bactgrowth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">time</span><span class="op">|</span><span class="va">strain</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">conc</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">bactgrowth</span>,</span>
<span>       groups <span class="op">=</span> <span class="va">replicate</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>While the <code>lattice</code> figure is not shown here, it has some
nice advantages. The call is even more compact and the applied formula
syntax
<code>dependend_variable ~ explanation_variable | grouping_variable</code>
can also be used in a similar manner by the growth curve fitting
functions starting with <code>all_*</code> to avoid loops or external
grouping.</p>
</div>
<div class="section level2">
<h2 id="estimation-of-growth-rates">Estimation of growth rates<a class="anchor" aria-label="anchor" href="#estimation-of-growth-rates"></a>
</h2>
<p>Package <strong>growthrates</strong> can determine growth parameters
from single experiments, from a complete series of experiments, or from
subsets in one step. Here we start with an overview over the ``single
subset’’-methods and show then examples for fitting growth models to the
full data set. More examples can be found on the help pages of the
package.</p>
<p>** Single data sets **</p>
<p>Single data sets can be analysed with functions
<code>fit_easylinear</code>, <code>fit_growthmodels</code> or
<code>fit_splines</code>. As a prerequisite, single data sets containing
only one treatment have to be extracted from a complete experiment,
which can be done with function `multsiplit’. In the following example,
the full data table is first split into a list of experiments according
to a vector of criteria and then the first experiment is extracted:</p>
<div class="section level3">
<h3 id="easy-linear-method">Easy Linear Method<a class="anchor" aria-label="anchor" href="#easy-linear-method"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splitted.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multisplit.html">multisplit</a></span><span class="op">(</span><span class="va">bactgrowth</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"strain"</span>, <span class="st">"conc"</span>, <span class="st">"replicate"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">splitted.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>In the next step, model fitting is done, e.g. with the “easylinear”
method:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_easylinear.html">fit_easylinear</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">time</span>, <span class="va">dat</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span></code></pre></div>
<p>This method fits segments of linear models to the log-transformed
data and tries to find the maximum growth rate. Several functions exist
to inspect the outcome of the model fit, e.g.:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = y ~ x)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##        1        2        3        4        5        6 </span></span>
<span><span class="co">##  0.02113 -0.03716 -0.03727  0.04552  0.06376 -0.05598 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -4.39425    0.06429  -68.35 2.74e-07 ***</span></span>
<span><span class="co">## x            0.20490    0.01336   15.34 0.000105 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.05587 on 4 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9833, Adjusted R-squared:  0.9791 </span></span>
<span><span class="co">## F-statistic: 235.3 on 1 and 4 DF,  p-value: 0.0001053</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>      <span class="co"># exponential growth parameters</span></span></code></pre></div>
<pre><code><span><span class="co">##        y0     y0_lm     mumax       lag </span></span>
<span><span class="co">## 0.0180000 0.0123482 0.2048985 1.8392607</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/generics.html">rsquared</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>  <span class="co"># coefficient of determination (of log-transformed data)</span></span></code></pre></div>
<pre><code><span><span class="co">##        r2 </span></span>
<span><span class="co">## 0.9832876</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>  <span class="co"># residual sum of squares of log-transformed data</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.01248744</span></span></code></pre>
<p>Plotting can then be done either in log-scale or after
re-transformation:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>and in addition to the original method of <span class="citation">Hall
et al. (2014)</span> it is also possible to modify the default settings
of the algorithm:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_easylinear.html">fit_easylinear</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">time</span>, <span class="va">dat</span><span class="op">$</span><span class="va">value</span>, h <span class="op">=</span> <span class="fl">8</span>, quota <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">fitx</span>, pch <span class="op">=</span> <span class="st">"+"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="parametric-nonlinear-growth-models">Parametric nonlinear growth models<a class="anchor" aria-label="anchor" href="#parametric-nonlinear-growth-models"></a>
</h3>
<p>A <strong>parametric growth model</strong> consists of a mathematical
formula that describes the growth of a population
(e.g. <code>grow_logistic</code>) and its parameters
(e.g. <code>y0</code>, <code>mumax</code>, and <code>K</code>,).
<strong>Fitting a parametric model</strong> is the process of estimating
an optimal parameter set that minimizes a given quality criterion. Here
we use the <em>method of least squares</em>, also known as <em>ordinary
least squares regression</em> (OLS). As most of the growth models are
non-linear, we need always a goof set of start parameters
<code>p</code>. It is wise to choose values for start parameters
carefully by considering the main properties of the selected growth
model (e.g. that the carrying capacity <code>K</code> should be around
the observed maximum of the data), or by experimentation, i.e. plotting
the model together with the data. In order to prevent unrealistic
(e.g. negative) parameter values, it is optionally possible to specify
box-constraints (<code>upper</code> and <code>lower</code>). For
difficult problems one may consider to change the involved model fitting
algorithm from Marquardt (<code>"Marq"</code>) to something else,
e.g. to <code>"L-BFGS-B"</code>. Details can be found on the
<code>?modFit</code> help page.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">0.01</span>, mumax <span class="op">=</span> <span class="fl">0.2</span>, K <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">1e-6</span>, mumax <span class="op">=</span> <span class="fl">0</span>,   K <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">0.05</span>, mumax <span class="op">=</span> <span class="fl">5</span>,   K <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_growthmodel.html">fit_growthmodel</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">grow_logistic</span>, p <span class="op">=</span> <span class="va">p</span>, <span class="va">dat</span><span class="op">$</span><span class="va">time</span>, <span class="va">dat</span><span class="op">$</span><span class="va">value</span>,</span>
<span>                        lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="fl">0.02</span>, ya <span class="op">=</span> <span class="fl">0.001</span>, kw <span class="op">=</span> <span class="fl">0.1</span>, mumax <span class="op">=</span> <span class="fl">0.2</span>, K <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="fl">1e-6</span>, ya <span class="op">=</span> <span class="fl">1e-6</span>, kw <span class="op">=</span> <span class="fl">0</span>,    mumax <span class="op">=</span> <span class="fl">0</span>,   K <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="fl">0.05</span>, ya <span class="op">=</span> <span class="fl">0.05</span>, kw <span class="op">=</span> <span class="fl">10</span>,   mumax <span class="op">=</span> <span class="fl">5</span>,   K <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_growthmodel.html">fit_growthmodel</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">grow_twostep</span>, p <span class="op">=</span> <span class="va">p</span>, time <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">time</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">value</span>,</span>
<span>                        lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         y0      mumax          K </span></span>
<span><span class="co">## 0.01748268 0.20006907 0.09962612</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yi          ya          kw       mumax           K </span></span>
<span><span class="co">## 0.013140465 0.004005239 8.659565328 0.202312435 0.099735868</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">fit2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">fit1</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">fit2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="section level5">
<h5 id="differential-equation-models">Differential equation models<a class="anchor" aria-label="anchor" href="#differential-equation-models"></a>
</h5>
<p>In the two-step model abode, growth is described as a two-step
process of adaption of inactive cells
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>
and logistic growth of active cells
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>a</mi></msub><annotation encoding="application/x-tex">y_a</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>y</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><msub><mi>k</mi><mi>w</mi></msub><mo>⋅</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\frac{dy_i}{dt} = - k_w \cdot y_i </annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>y</mi><mi>a</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>k</mi><mi>w</mi></msub><mo>⋅</mo><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><msub><mi>μ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>⋅</mo><msub><mi>y</mi><mi>a</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><mrow><msub><mi>y</mi><mi>a</mi></msub><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>K</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{dy_a}{dt} =   k_w \cdot y_i + \mu_{max} \cdot
  y_a \cdot \left(1 - \frac{y_a + y_i}{K} \right)</annotation></semantics></math></p>
<p>with amount of total organisms
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><msub><mi>y</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">y = y_i + y_a</annotation></semantics></math>,
and an adaption rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>w</mi></msub><annotation encoding="application/x-tex">k_w</annotation></semantics></math>,
intrinsic growth rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{max}</annotation></semantics></math>,
and carrying capacity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>.
The initial abundance (normally
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>0</mn></msub><annotation encoding="application/x-tex">y_0</annotation></semantics></math>)
is splitted in two separate values,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mo>,</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">y_{i,0}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>a</mi><mo>,</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">y_{a,0}</annotation></semantics></math>
that are by default also fitted.</p>
<p>The underlying ordinary differential equation (ODE) model has no
simple analytical solution and is therefore solved numerically using a
differential solver from package <strong>deSolve</strong>. Here both,
the model and the solver are running in compiled code (C resp. Fortran),
but it is of course also possible to define user-specified models in R
code. Details can be found in <em>Part 2</em> of the package
documentation.</p>
</div>
<div class="section level5">
<h5 id="selective-parameter-fitting">Selective parameter fitting<a class="anchor" aria-label="anchor" href="#selective-parameter-fitting"></a>
</h5>
<p>Despite the fact that the above model is solved as a differential
equation, the relatively high number of parameters may need special
care, too. In such cases, package growthrates allows to fit subsets of
parameters while setting the others to fixed values. In the following,
this is done by specifying a subset without initial abundances
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>a</mi></msub><annotation encoding="application/x-tex">y_a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>
in <code>which</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_growthmodel.html">fit_growthmodel</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">grow_twostep</span>, p <span class="op">=</span> <span class="va">p</span>, time <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">time</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">value</span>,</span>
<span>                        lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kw"</span>, <span class="st">"mumax"</span>, <span class="st">"K"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## kw     9.791445  66.893493   0.146    0.885    </span></span>
<span><span class="co">## mumax  0.174802   0.015625  11.188 7.64e-12 ***</span></span>
<span><span class="co">## K      0.101923   0.002429  41.958  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.00452 on 28 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameter correlation:</span></span>
<span><span class="co">##            kw   mumax       K</span></span>
<span><span class="co">## kw     1.0000 -0.8893  0.5405</span></span>
<span><span class="co">## mumax -0.8893  1.0000 -0.7735</span></span>
<span><span class="co">## K      0.5405 -0.7735  1.0000</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        yi        ya        kw     mumax         K </span></span>
<span><span class="co">## 0.0200000 0.0010000 9.7914448 0.1748016 0.1019230</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>We see that <code>summary</code> shows only the fitted parameters
whereas <code>coef</code> contains the full set.</p>
<p>Note however, that start values need to be given in <code>p</code>
for all model parameters, i.e. for both the fitted and the fixed ones,
while <code>upper</code> and <code>lower</code> bounds for the fixed
parameters can be omitted.</p>
</div>
</div>
<div class="section level3">
<h3 id="nonparametric-smoothing-splines">Nonparametric smoothing splines<a class="anchor" aria-label="anchor" href="#nonparametric-smoothing-splines"></a>
</h3>
<p>Smoothing splines are a quick method to estimate maximum growth. The
method is called <em>nonparametric</em>, because the growth rate is
directly estimated from the smoothed data without being restricted to a
specific model formula.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">splitted.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">y</span>    <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">value</span></span>
<span></span>
<span><span class="co">## automatic smoothing with cv</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_spline.html">fit_spline</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">res</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          y0       mumax </span></span>
<span><span class="co">## 0.006562443 0.335991063</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="fit-multiple-data-sets-without-loops">Fit multiple data sets without loops<a class="anchor" aria-label="anchor" href="#fit-multiple-data-sets-without-loops"></a>
</h2>
<p>Fitting multiple data sets at once is possible with functions
<code>all_easylinear</code>, <code>all_growthmodels</code> and
<code>all_splines</code>. Usage is similar for all methods, and the
parameters are analogous to the single-fit methods. Both, the easy
growth rates and the smooting splines method are quite robust. In
contrast to this, parametric fits with function
<code>all_growthmodels</code> need more care and a little bit more
computational power.</p>
<p>Again, special emphasis should be given to the selection of good
starting points. In addition, it is possible to select an alternative
optimization algorithm, to enable additional output (<code>trace</code>)
or to fine-tune their optimization control parameters. Nevertheless, it
should be noted that parametric models have more explanatory power and
may therefore be advantageous for basic research.</p>
<p>Nonlinear optimization is done with parallelized code, so multi-core
computers can speed up computation.</p>
<div class="section level3">
<h3 id="fit-smoothing-splines-to-multiple-data">Fit smoothing splines to multiple data<a class="anchor" aria-label="anchor" href="#fit-smoothing-splines-to-multiple-data"></a>
</h3>
<p>It can be a good idea, to start with a nonparametric approach like
the smoothing spline method to get a first impression and, potentially,
to derive start parameters for a parametric model. In the following, we
show an example with the smoothing spline method. The function uses a
formula interface with the syntax:
<code>dependent_variable ~ independent_variable | group1 + group 2 + ...</code>:</p>
<p>In this example, smoothness is set to a moderate value
(<code>spar = 0.5</code>). Other values between zero and one will result
in different degrees of smoothing. If <code>spar</code> is omitted,
leave-one-out cross-validation is used to determine smoothness
automatically. This works best if the samples over time are true
replicates from independent experimental units, instead of
pseudo-replicates with potential autocorrelation.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">many_spline_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/all_splines.html">all_splines</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">strain</span> <span class="op">+</span> <span class="va">conc</span> <span class="op">+</span> <span class="va">replicate</span>,</span>
<span>                                data <span class="op">=</span> <span class="va">bactgrowth</span>, spar <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">many_spline_fits</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-16-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="fit-parametric-models-to-multiple-data">Fit parametric models to multiple data<a class="anchor" aria-label="anchor" href="#fit-parametric-models-to-multiple-data"></a>
</h3>
<p>Package <strong>growthrates</strong> allows to fit parametric models
to a series of grouped data. The formula interface of function
<code>all_growthmodels</code> allows to include the name of the
nonlinear model (the <code>grow_....</code>-function) and the name of
the independent variable (e.g. <code>time</code>) as its first argument,
for example as <code>grow_logistic(time, parms)</code>. The second
argument <code>parms</code> is a dummy argument; its name does currently
not (yet) matter. Model fitting can make use of multiple CPU cores to
speed up computation. If the <code>ncores</code> argument is omitted,
the number of cores is automatically detected while setting
<code>ncores = 1</code> can be useful for debugging.</p>
<p>In the following, let’s fit a Baranyi growth model <span class="citation">(Baranyi and Roberts 1995)</span> to the data, a model
that considers the lag phase as as a period to build up ``critical
substances’’ needed for growth. The model is based on a system of two
differential equations for which under some simplifying assumptions an
analytical solution was presented.</p>
<p>In a first attempt, we fit all parameters of the model:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## initial parameters and box constraints</span></span>
<span><span class="va">p</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">0.03</span>, mumax <span class="op">=</span> <span class="fl">.1</span>, K <span class="op">=</span> <span class="fl">0.1</span>, h0 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lower</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">0.001</span>, mumax <span class="op">=</span> <span class="fl">1e-2</span>, K <span class="op">=</span> <span class="fl">0.005</span>, h0 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">upper</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">0.1</span>,   mumax <span class="op">=</span> <span class="fl">1</span>,    K <span class="op">=</span> <span class="fl">0.5</span>,   h0 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## fit growth models to all data using log transformed residuals</span></span>
<span><span class="va">many_baranyi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/all_growthmodels.html">all_growthmodels</a></span><span class="op">(</span></span>
<span>                   <span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="../reference/grow_baranyi.html">grow_baranyi</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">|</span> <span class="va">strain</span> <span class="op">+</span> <span class="va">conc</span> <span class="op">+</span> <span class="va">replicate</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">bactgrowth</span>,</span>
<span>                   p <span class="op">=</span> <span class="va">p</span>, lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span>,</span>
<span>                   transform <span class="op">=</span> <span class="st">"log"</span>, ncores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>whereas in a second trial, <code>h0</code> is fixed to a common value
to avoid that <code>h0</code> consumes parts of the effect because of
interdependency between <code>h0</code> and <code>mumax</code>:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## use coefficients of first fit as new initial parameters</span></span>
<span><span class="va">pp</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">many_baranyi1</span><span class="op">)</span></span>
<span><span class="co">## but set h0 to a fixed value</span></span>
<span><span class="va">pp</span><span class="op">[</span>, <span class="st">"h0"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.65</span></span>
<span><span class="co">## re-fit models</span></span>
<span><span class="va">many_baranyi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/all_growthmodels.html">all_growthmodels</a></span><span class="op">(</span></span>
<span>                   <span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="../reference/grow_baranyi.html">grow_baranyi</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">|</span> <span class="va">strain</span> <span class="op">+</span> <span class="va">conc</span> <span class="op">+</span> <span class="va">replicate</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">bactgrowth</span>,</span>
<span>                   p <span class="op">=</span> <span class="va">pp</span>, lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span>,</span>
<span>                   which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y0"</span>, <span class="st">"mumax"</span>, <span class="st">"K"</span><span class="op">)</span>, transform <span class="op">=</span> <span class="st">"log"</span>, ncores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The result of the second fit is shown in the following figure. It may
be noted that even better fits are possible with models with more
parameters, e.g. <span class="citation">Huang (2011)</span>, again at
the cost that the effect of antibiotics is distributed over several
correlated parameters instead of an effect of the maximum growth
rate.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">many_baranyi2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-19-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="dose-respone-curves">Dose Respone Curves<a class="anchor" aria-label="anchor" href="#dose-respone-curves"></a>
</h3>
<p>Dependency of growth rate on antibiotic concentration for the three
strains with the spline fit and the Baranyi model. Here we first extract
a table of results from the fitted objects:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">many_spline_res</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generics.html">results</a></span><span class="op">(</span><span class="va">many_spline_fits</span><span class="op">)</span></span>
<span><span class="va">many_baranyi2_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generics.html">results</a></span><span class="op">(</span><span class="va">many_baranyi2</span><span class="op">)</span></span></code></pre></div>
<p>The resulting data frames follow a “tidy structure” ensuring
compatibility with <strong>ggplot2</strong>.</p>
<div class="section level4">
<h4 id="nonparameric-spline-fits">Nonparameric Spline Fits<a class="anchor" aria-label="anchor" href="#nonparameric-spline-fits"></a>
</h4>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">many_spline_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">conc</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">mumax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">strain</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre>
<p><img src="Introduction_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="parametric-baranyi-model">Parametric Baranyi Model<a class="anchor" aria-label="anchor" href="#parametric-baranyi-model"></a>
</h4>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">many_baranyi2_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">conc</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">mumax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">strain</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre>
<p><img src="Introduction_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>As an alternative, visualization is also possible with R’s “base
graphics” functions or with <strong>lattice</strong> graphics:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">mumax</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">conc</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">|</span><span class="va">strain</span>, data <span class="op">=</span> <span class="va">many_spline_res</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">mumax</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">conc</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">|</span><span class="va">strain</span>, data <span class="op">=</span> <span class="va">many_baranyi2_res</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Describing the observed dependency can again be approached with
nonparametric methods or parametric functional response curves, which
may be done using a specialized package for dose-response curves, for
example package <strong>drc</strong> <span class="citation">(Ritz and
Streibig 2005)</span>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>Many thanks to Claudia Seiler for the data set, and to the R Core
Team <span class="citation">(R Core Team 2015)</span> for developing and
maintaining <strong>R</strong>. This documentation was written using
<strong>knitr</strong> <span class="citation">(Xie 2014)</span> and
<strong>rmarkdown</strong> <span class="citation">(Allaire et al.
2015)</span>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-rmarkdown" class="csl-entry">
Allaire, JJ, Joe Cheng, Yihui Xie, Jonathan McPherson, Winston Chang,
Jeff Allen, Hadley Wickham, and Rob Hyndman. 2015. <em><span class="nocase">rmarkdown</span>: Dynamic Documents for r</em>. <a href="https://CRAN.R-project.org/package=rmarkdown" class="external-link">https://CRAN.R-project.org/package=rmarkdown</a>.
</div>
<div id="ref-Baranyi1995" class="csl-entry">
Baranyi, Jozsef, and Terry A. Roberts. 1995. <span>“Mathematics of
Predictive Food Microbiology.”</span> <em>International Journal of Food
Microbiology</em> 26 (2): 199–218. <a href="https://doi.org/10.1016/0168-1605(94)00121-L" class="external-link">https://doi.org/10.1016/0168-1605(94)00121-L</a>.
</div>
<div id="ref-Hall2014" class="csl-entry">
Hall, B. G., H. Acar, A. Nandipati, and M. Barlow. 2014. <span>“Growth
Rates Made Easy.”</span> <em>Mol. Biol. Evol.</em> 31: 232–38. <a href="https://doi.org/10.1093/molbev/mst197" class="external-link">https://doi.org/10.1093/molbev/mst197</a>.
</div>
<div id="ref-Huang2011" class="csl-entry">
Huang, Lihan. 2011. <span>“A New Mechanistic Growth Model for
Simultaneous Determination of Lag Phase Duration and Exponential Growth
Rate and a New Belehdredek-Type Model for Evaluating the Effect of
Temperature on Growth Rate.”</span> <em>Food Microbiology</em> 28 (4):
770–76. <a href="https://doi.org/10.1016/j.fm.2010.05.019" class="external-link">https://doi.org/10.1016/j.fm.2010.05.019</a>.
</div>
<div id="ref-Kahm2010" class="csl-entry">
Kahm, Matthias, Guido Hasenbrink, Hella Lichtenberg-Frate, Jost Ludwig,
and Maik Kschischo. 2010. <span>“Grofit: Fitting Biological Growth
Curves with r.”</span> <em>Journal of Statistical Software</em> 33 (7):
1–21. <a href="https://doi.org/10.18637/jss.v033.i07" class="external-link">https://doi.org/10.18637/jss.v033.i07</a>.
</div>
<div id="ref-RCore2015" class="csl-entry">
R Core Team. 2015. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
<div id="ref-Ritz2005" class="csl-entry">
Ritz, Christian, and Jens C. Streibig. 2005. <span>“Bioassay Analysis
Using r.”</span> <em>Journal of Statistical Software</em> 12 (5): 1–22.
<a href="https://doi.org/10.18637/jss.v012.i05" class="external-link">https://doi.org/10.18637/jss.v012.i05</a>.
</div>
<div id="ref-Soetaert2010" class="csl-entry">
Soetaert, Karline, and Thomas Petzoldt. 2010. <span>“Inverse Modelling,
Sensitivity and Monte Carlo Analysis in Using Package .”</span>
<em>Journal of Statistical Software</em> 33 (3): 1–28. <a href="https://doi.org/10.18637/jss.v033.i03" class="external-link">https://doi.org/10.18637/jss.v033.i03</a>.
</div>
<div id="ref-deSolve_jss" class="csl-entry">
Soetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010.
<span>“Solving Differential Equations in : Package .”</span> <em>Journal
of Statistical Software</em> 33 (9): 1–25. <a href="https://doi.org/10.18637/jss.v033.i09" class="external-link">https://doi.org/10.18637/jss.v033.i09</a>.
</div>
<div id="ref-knitr2014" class="csl-entry">
Xie, Yihui. 2014. <span>“<span class="nocase">knitr</span>: A
Comprehensive Tool for Reproducible Research in <span>R</span>.”</span>
In <em>Implementing Reproducible Computational Research</em>, edited by
Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman;
Hall/CRC. <a href="https://www.routledge.com/Implementing-Reproducible-Research/Stodden-Leisch-Peng/p/book/9781466561595" class="external-link">https://www.routledge.com/Implementing-Reproducible-Research/Stodden-Leisch-Peng/p/book/9781466561595</a>.
</div>
</div>
<hr>
<p><strong>Copyright and original author:</strong> <a href="https://github.com/tpetzoldt" class="external-link">tpetzoldt</a>, 2025-08-28</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Petzoldt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
